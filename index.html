<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>未知的首爾 - 線上觀看</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1>未知的首爾</h1>
        <div class="episode-list">
            <div class="episode-card">
                <h3>第一集</h3>
                <p>開始探索首爾的未知面貌</p>
                <a href="player.html?episode=1" class="btn btn-primary">立即觀看</a>
            </div>
            <div class="episode-card">
                <h3>第二集</h3>
                <p>深入首爾的在地生活</p>
                <div class="watch-options">
                    <a href="#" class="btn btn-success premium" onclick="showLoginModal()">會員觀看</a>
                    <a href="#" class="btn btn-success premium" onclick="showPayPerViewModal()">查詢帳密</a>
                </div>
            </div>
            <div class="episode-card">
                <h3>第三集</h3>
                <p>探索首爾的美食文化</p>
                <div class="watch-options">
                    <a href="#" class="btn btn-success premium" onclick="showLoginModal()">會員觀看</a>
                    <a href="#" class="btn btn-success premium" onclick="showPayPerViewModal()">查詢帳密</a>
                </div>
            </div>
        </div>
        <hr style="margin-top: 30px; margin-bottom: 30px;">
        <h1>新社花海</h1>
        <div class="episode-list">
            <div class="episode-card">
                <h3>第一集</h3>
                <p>新社花海的第一集</p>
                <a href="player.html?episode=4" class="btn btn-primary disabled">等待製作中...</a>
            </div>
            <div class="episode-card">
                <h3>第一集</h3>
                <p>新社花海的第一集</p>
                <a href="#" class="btn btn-primary disabled">尚未發布</a>
            </div>
        </div>
        <hr style="margin-top: 30px; margin-bottom: 30px;">
        <h1>其他</h1>
        <div class="episode-list">
            <div class="episode-card">
                <h3>釜山行</h3>
                <p>Vlog_Subtitles_720</p>
                <a href="player.html?episode=5" class="btn btn-primary">立即觀看</a>
            </div>
            <div class="episode-card">
                <h3>We Are In SEOUL.</h3>
                <p>20250618～202500622</p>
                <a href="player.html?episode=6" class="btn btn-primary">立即觀看</a>
            </div>
        </div>
    </div>

    <div id="loginModal">
        <div class="modal-content bg-white text-dark w-50">
            <h2>會員登入</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">帳號</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password">密碼</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn btn-primary">登入</button>
                <button type="button" class="btn btn-secondary" onclick="closeLoginModal()">取消</button>
            </form>
            <p class="info-text">需要帳號密碼？請使用"查詢帳密"功能申請。</p>
        </div>
    </div>



    <div id="payPerViewModal">
        <div class="modal-content bg-white text-dark w-50">
            <h2>查詢帳密</h2>
            <div class="price-info">
                <div>原本觀看費用為</div>
                <div class="amount">NT$ 200</div>
                <div>單集觀看權限</div>
            </div>
            <form id="payPerViewForm">
                <div class="form-group">
                    <label for="ppv-email">電子郵件</label>
                    <input type="email" id="ppv-email" placeholder="example@email.com" required>
                </div>
                <p class="info-text">提交後，我們將透過電子郵件發送帳號密碼給您。</p>
                <button type="submit" class="btn btn-success">提交申請</button>
                <button type="button" class="btn btn-secondary" onclick="closePayPerViewModal()">取消</button>
            </form>
        </div>
    </div>

    <script>
        let currentEpisode = '2';

        function showLoginModalWithEpisode(episode) {
            currentEpisode = episode;
            document.getElementById('loginModal').style.display = 'block';
        }

        function showPayPerViewModalWithEpisode(episode) {
            currentEpisode = episode;
            document.getElementById('payPerViewModal').style.display = 'block';
        }

        function showLoginModal() {
            showLoginModalWithEpisode('2');
        }

        function showPayPerViewModal() {
            showPayPerViewModalWithEpisode('2');
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
        }

        function closePayPerViewModal() {
            document.getElementById('payPerViewModal').style.display = 'none';
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // 驗證客戶和管理員帳號
            if ((username === 'user' && password === '1234') || (username === 'ad' && password === '12345678')) {
                alert('登入成功！');
                window.location.href = `player.html?episode=${currentEpisode}`;
            } else {
                alert('帳號或密碼錯誤！');
            }
        });



        document.getElementById('payPerViewForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const email = document.getElementById('ppv-email').value;
            const timestamp = new Date().toLocaleString('zh-TW');
            
            try {
                const response = await fetch('save_email.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: `email=${encodeURIComponent(email)}&timestamp=${encodeURIComponent(timestamp)}`,
                });
                
                if (response.ok) {
                    alert('申請已提交！我們將盡快將帳號密碼發送至您的信箱。');
                    closePayPerViewModal();
                } else {
                    alert('系統錯誤，請稍後再試。');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('系統錯誤，請稍後再試。');
            }
        });
    </script>
</body>
</html>